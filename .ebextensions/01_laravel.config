container_commands:
  01_create_storage_dirs:
    command: "mkdir -p storage/framework/sessions storage/framework/views storage/framework/cache/data storage/logs bootstrap/cache"
  02_set_permissions:
    command: "chmod -R 775 storage bootstrap/cache"
  03_set_ownership:
    command: "chown -R webapp:webapp storage bootstrap/cache"
  04_storage_link:
    command: "php artisan storage:link || true"
  05_migrate:
    command: "php artisan migrate --force || true"
    leader_only: true

option_settings:
  aws:elasticbeanstalk:container:php:phpini:
    document_root: /public
