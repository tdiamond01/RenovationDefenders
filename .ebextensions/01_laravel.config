container_commands:
  01_create_storage_dirs:
    command: "mkdir -p storage/framework/sessions storage/framework/views storage/framework/cache/data storage/logs bootstrap/cache"
  02_set_permissions:
    command: "chmod -R 775 storage bootstrap/cache"
  03_set_ownership:
    command: "chown -R webapp:webapp storage bootstrap/cache"
  04_clear_cache:
    command: "php artisan cache:clear || true"
  05_clear_config:
    command: "php artisan config:clear || true"
  06_clear_route:
    command: "php artisan route:clear || true"
  07_clear_view:
    command: "php artisan view:clear || true"
  08_storage_link:
    command: "php artisan storage:link || true"
  09_migrate:
    command: "php artisan migrate --force || true"
    leader_only: true
  10_config_cache:
    command: "php artisan config:cache || true"
  11_route_cache:
    command: "php artisan route:cache || true"
  12_view_cache:
    command: "php artisan view:cache || true"

option_settings:
  aws:elasticbeanstalk:container:php:phpini:
    document_root: /public
