option_settings:
  aws:elasticbeanstalk:container:php:phpini:
    document_root: /public
    memory_limit: 256M
    max_execution_time: 300

  aws:elasticbeanstalk:application:environment:
    APP_ENV: production
    APP_DEBUG: false
    LOG_CHANNEL: errorlog
    SESSION_DRIVER: file
    CACHE_DRIVER: file

container_commands:
  01_set_permissions:
    command: |
      chmod -R 775 storage bootstrap/cache
      chown -R webapp:webapp storage bootstrap/cache
    ignoreErrors: false

  02_composer_optimize:
    command: |
      export COMPOSER_HOME=/root
      composer install --no-dev --optimize-autoloader --no-interaction
    ignoreErrors: false
